"use strict";const e=require("../../common/vendor.js"),u=require("../../state/modules/actions.js"),p=require("../../api/courses/courses.js"),g=require("../../api/action/action.js");require("../../utils/request.js");if(!Array){const l=e.resolveComponent("van-checkbox"),f=e.resolveComponent("van-icon");(l+f)()}const D=e.defineComponent({__name:"index",props:{title:{type:String,required:!1},startDate:{type:String,required:!1},endDate:{type:String,required:!1},status:{type:Number,required:!0},actionGroups:{type:Array,required:!0},isHideHeader:{type:Boolean,required:!1}},emits:["del"],setup(l,{emit:f}){const c=l,n=e.ref(c.actionGroups),v=e.H(),T=(o,i)=>{if(!o)return"";const t=e.dayjs(o).format("YYYY-MM-DD");return i?`${t} - ${e.dayjs(i).format("YYYY-MM-DD")}`:`创建于 ${t}`},m=o=>{console.log(o,"item"),u.useActionsStore().setFindActionData({Type:o.Type.toUpperCase()}),console.log(u.useActionsStore().getFindActionData,"useActionsStore"),u.useActionsStore().setPlanList(o),u.useActionsStore().setTime(o.PlanTime),u.useActionsStore().setChooseActionId(o.ID),v.push({path:"/subpackages/calender/index?id="+o.ID})},h=(o,i,t)=>{if(i&&u.useActionsStore().getCoachID!==0){e.index.showToast({title:"已完成打卡，如需取消请联系对应教练取消取消",icon:"none",duration:2e3,mask:!1}),n.value[t].Complete=!0,n.value=[...n.value];return}i?i&&e.index.showModal({title:"取消",content:"是否取消打卡？",confirmText:"确定",cancelText:"取消",success:s=>{s.confirm?p.actionClok(o).then(a=>{if(a.data.code!==200){e.index.showToast({title:a.data.msg,icon:"error",duration:2e3});return}n.value[t].Complete=!1,e.index.showToast({title:"成功",icon:"success",duration:2e3,mask:!1}),setTimeout(()=>{console.log("取消打卡成功"),e.index.$emit("reload",!0)},2200)}).catch(a=>{e.index.showToast({title:r.data.msg,icon:"error",duration:2e3,mask:!1}),console.error("打卡失败",a)}):(e.index.showToast({title:"已取消",icon:"none",duration:2e3,mask:!1}),n.value[t].Complete=!0,n.value=[...n.value])}}):e.index.showModal({title:"日常打卡",content:"是否进行打卡？",confirmText:"确定",cancelText:"取消",success:s=>{s.confirm?p.actionClok(o).then(a=>{if(console.log(a,"res"),a.data.code!==200){e.index.showToast({title:a.data.msg,icon:"error",duration:2e3});return}n.value[t].Complete=!0,e.index.showToast({title:"成功",icon:"success",duration:2e3,mask:!1}),setTimeout(()=>{e.index.$emit("reload",!0)},2200)}).catch(a=>{e.index.showToast({title:r.data.msg,icon:"error",duration:2e3,mask:!1}),console.error("打卡失败",a)}):(e.index.showToast({title:"已取消打卡",icon:"none",duration:2e3,mask:!1}),n.value[t].Complete=!1,n.value=[...n.value])}})},C=async o=>{const i={id:o.ID};console.log(i,o,"item"),(await g.deletePlan(i)).data.code===200?(f("del",o),e.index.showToast({title:"删除成功",icon:"success"})):e.index.showToast({title:"删除失败",icon:"error"})};return e.watch(()=>c.actionGroups,o=>{n.value=o},{immediate:!0,deep:!0}),(o,i)=>e.e({a:!l.isHideHeader},l.isHideHeader?{}:e.e({b:e.t(c.title),c:c.startDate},c.startDate?{d:e.t(T(c.startDate,c.endDate))}:{},{e:e.t(c.status?"已完成":"进行中"),f:e.f(n.value,(t,s,a)=>({a:"fb7a90af-0-"+a,b:e.p({checkedColor:"#1cbbb4",iconSize:"24px",value:t.Complete,checked:t.Complete}),c:e.o(d=>h(t.ID,t.Complete,s),s),d:e.t(t.PlanTitle===""?`私教课第 ${s+1} 节`:t.PlanTitle),e:e.t(t.PlanTime.split(" ")[0]),f:e.o(d=>m(t),s),g:s}))}),{g:l.isHideHeader},l.isHideHeader?{h:e.f(n.value,(t,s,a)=>e.e({a:"fb7a90af-1-"+a,b:e.p({checkedColor:"#1cbbb4",iconSize:"24px",value:t.Complete,checked:t.Complete}),c:e.o(d=>h(t.ID,t.Complete,s),s),d:e.t(t.PlanTitle===""?`私教课第 ${s+1}节`:t.PlanTitle),e:e.t(t.PlanTime),f:!t.Complete},t.Complete?{}:{g:"fb7a90af-2-"+a,h:e.p({name:"minus",size:"14px",color:"#fff"}),i:e.o(d=>C(t),s)},{j:s,k:e.o(d=>m(t),s)}))}:{})}}),x=e._export_sfc(D,[["__scopeId","data-v-fb7a90af"],["__file","J:/fItness/wx-fitness/apps/fitness/src/components/plan-card/index.vue"]]);wx.createComponent(x);
