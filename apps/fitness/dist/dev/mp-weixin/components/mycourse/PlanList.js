"use strict";const e=require("../../common/vendor.js"),h=require("../../api/courses/courses.js"),a=require("../../state/modules/actions.js");require("../../utils/request.js");if(!Array){const i=e.resolveComponent("van-empty"),c=e.resolveComponent("van-checkbox");(i+c)()}const v=e.defineComponent({__name:"PlanList",props:{type:{type:String,required:!0},list:{type:Array,required:!0,default:()=>[]},CoachName:{type:String,required:!0,default:""},LessonCount:{type:String,required:!0,default:""},EndTime:{type:String,required:!0,default:""}},setup(i){const c=i,l=e.H(),s=e.ref([]),m=o=>{s.value=o.filter(r=>r.Type===c.type&&!r.Complete)},p=o=>{console.log(o,"plan"),a.useActionsStore().setFindActionData({Type:o.Type.toUpperCase()});let r={title:o.PlanTitle||"私教课",day:o.PlanTime,status:o.Complete?1:0,id:o.ID,actionGroups:o.ActionGroups.map((t,n)=>({title:t.ActionGroupTitle||`动作${n+1}`,date:"",status:t.Complete||0,List:t.PlanActions,type:t.ContentType}))};console.log(r,"temp"),a.useActionsStore().setPlanList(r),a.useActionsStore().setTime(o.PlanTime),a.useActionsStore().setChooseActionId(o.ID),l.push({path:"/subpackages/calender/index"})},d=(o,r,t)=>{if(r){e.index.showToast({title:"已完成打卡，如需取消请联系对应教练取消取消",icon:"none",duration:2e3,mask:!1}),s.value[t].Complete=!0,s.value=[...s.value];return}e.index.showModal({title:"日常打卡",content:"是否进行打卡？",confirmText:"确定",cancelText:"取消",success:n=>{n.confirm?h.actionClok(o).then(()=>{s.value[t].Complete=!0,e.index.showToast({title:"成功",icon:"success",duration:2e3,mask:!1}),e.index.$emit("refreshAction",!0)}).catch(u=>{e.index.showToast({title:"打卡失败",icon:"error",duration:2e3,mask:!1}),console.error("打卡失败",u)}):(e.index.showToast({title:"已取消打卡",icon:"none",duration:2e3,mask:!1}),s.value[t].Complete=!1,s.value=[...s.value])}})};return e.watch(()=>c.list,o=>{m(o)},{immediate:!0,deep:!0}),(o,r)=>e.e({a:s.value.length===0},s.value.length===0?{b:e.p({description:`暂无未完成的${i.type==="online"?"线上任务":"线下计划"}`})}:{c:e.f(s.value,(t,n,u)=>({a:"e6a3228e-1-"+u,b:e.p({checkedColor:"#1cbbb4",iconSize:"24px",value:t.Complete,checked:t.Complete}),c:e.o(f=>d(t.ID,t.Complete,n),n),d:e.t(t.PlanTitle===""?`私教课第 ${n+1} 节`:t.PlanTitle),e:e.t(t.PlanTime.split(" ")[0]),f:n,g:e.o(f=>p(t),n)})),d:e.t(i.CoachName)})}}),C=e._export_sfc(v,[["__scopeId","data-v-e6a3228e"],["__file","J:/fItness/wx-fitness/apps/fitness/src/components/mycourse/PlanList.vue"]]);wx.createComponent(C);
