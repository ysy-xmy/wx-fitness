"use strict";const c=require("../../common/vendor.js"),i=require("../../utils/request.js");function u(){const t=new Date,s=t.getFullYear(),o=("0"+(t.getMonth()+1)).slice(-2),e=("0"+t.getDate()).slice(-2);return`${s}${o}${e}`}const r=()=>i.http.get("/api/user/oss"),l=t=>new Promise(async(s,o)=>{const e=await(await r()).data.data;console.log(e);const n=u()+"/"+Date.now()+t.substring(t.lastIndexOf("."));console.log("文件路径",n),c.index.uploadFile({url:"https://zhanjiang-fitness.oss-cn-guangzhou.aliyuncs.com",filePath:t,name:"file",formData:{key:n,OSSAccessKeyId:e.AccessKeyId,policy:e.PolicyBase64,signature:e.Signature,"x-oss-security-token":e.SecurityToken},success:a=>{console.log("https://zhanjiang-fitness.oss-cn-guangzhou.aliyuncs.com/"+n),s("https://zhanjiang-fitness.oss-cn-guangzhou.aliyuncs.com/"+n)},fail:a=>{console.log(a),c.index.showToast({title:"图片获取失败！",icon:"none",duration:2e3})}})}),g=t=>i.http.post("/api/pay/culAmount",t);exports.getPrice=g;exports.uploadimg=l;
